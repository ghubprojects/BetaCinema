@page "/admin/payments"
@layout AdminLayout
@inherits TableBase

<AuthorizeView Roles="Admin">
    <NotAuthorized>
        <RedirectToLogin />
    </NotAuthorized>
    <Authorized>
        <MudPaper Elevation="0">
            <MudPaper Elevation="0" Class="d-flex gap-4 justify-space-between align-items-center admin-table-title">
                <h3 class="mb-0">@string.Format(SharedResources.TableTitle, "hóa đơn")</h3>
                <div class="form-group d-flex gap-2">
                    <MudButton Variant="@Variant.Filled"
                               Color="@Color.Primary"
                               OnClick="@NavigateToCheckoutForm">
                        Checkout
                        <MudIcon Size="Size.Small" Icon="@Icons.Material.Filled.Add" />
                    </MudButton>
                    <MudButton Variant="@Variant.Filled"
                               Color="@Color.Primary"
                               OnClick="@DownloadExcelFile">
                        @SharedResources.ExportExcel
                        <MudIcon Size="Size.Small" Icon="@Icons.Material.Filled.CloudDownload" Class="ml-2" />
                    </MudButton>
                </div>
            </MudPaper>
        </MudPaper>

        <br>

        @if (payments == null)
        {
            <text>@SharedResources.Loading</text>
        }
        else if (payments.Count == 0)
        {
            <text>@SharedResources.NoRecord</text>
        }
        else
        {
            <MudDataGrid Items="@payments" Elevation="0" Filterable="false" SortMode="@SortMode.None"
                         Groupable="false" FixedHeader="true" Class="admin-table">
                <Columns>
                    <PropertyColumn Property="x => x.Id" StickyLeft="true" />
                    <PropertyColumn Property="x => x.ReservationId" />
                    <PropertyColumn Property="x => x.TotalPrice" />
                    <TemplateColumn StickyRight="true" Title="@SharedResources.OptionsColumnTitle">
                        <CellTemplate Context="tableContext">
                            <MudStack Row>
                             <MudButton Size="@Size.Small" Variant="@Variant.Filled" Color="@Color.Error"
                                        OnClick="@(() => Delete(tableContext.Item.Id))">
                                 @SharedResources.Delete
                             </MudButton>
                         </MudStack>
                     </CellTemplate>
                 </TemplateColumn>
             </Columns>
         </MudDataGrid>
        }
    </Authorized>
</AuthorizeView>