@page "/checkout"
@inherits CheckoutBase

<div class="checkout-container">
    <div class="checkout-wrapper d-flex gap-8">
        <MudCard Elevation="0" Class="d-flex justify-content-between"
                 Style="@($"background-color:{Colors.Grey.Lighten4};width:68%")">
            <MudCardContent Class="p-0 flex-1 d-flex flex-column gap-4">
                <MudText Class="my-6">
                    <p class="page-title-wrapper">
                        <span class="link-title">Trang chủ</span> > <span class="link-title">Đặt vé</span> > <span class="link-title">Arkie và Ngày Mặt Trời Mất Tích</span>
                    </p>
                </MudText>

                <MudPaper Elevation="0" Style="@($"background-color:{Colors.Grey.Lighten4}")">
                    <div class="title-wrapper">
                        <MudImage Src="/assets/images/payment-user-info.png" Width="36" />
                        <p class="title">Thông tin thanh toán</p>
                    </div>

                    <div class="user-info">
                        <div class="user-info-item">
                            <span class="user-info-item-label">Họ Tên: </span><br>
                            <span class="user-info-item-value">
                                @ReservationState.Value.UserFullName
                            </span>
                        </div>
                        <div class="user-info-item">
                            <span class="user-info-item-label">Email: </span><br>
                            <span class="user-info-item-value">
                                @ReservationState.Value.UserEmail
                            </span>
                        </div>
                    </div>

                    <br />

                    <div class="total-price">
                        <div class="seat-type">Ghế VIP</div>
                        <div class="seat-quantity">
                            @(string.Format("{0} x {1} vnđ", ReservationState.Value.SelectedSeat.Count,
                                ReservationState.Value.Showtime.TicketPrice.ToString("#,##0")))
                        </div>
                        <div class="seat-money">
                            @(string.Format("= {0} vnđ", totalPrice.ToString("#,##0")))
                        </div>
                    </div>

                    <hr class="divider" />
                </MudPaper>


                <MudPaper Elevation="0" Style="@($"background-color:{Colors.Grey.Lighten4}")">
                    <div class="title-wrapper">
                        <MudImage Src="/assets/images/payment-method.png" Width="36" />
                        <p class="title">Phương thức thanh toán</p>
                    </div>

                    <div class="payment-method">
                        <div class="option-title">Chọn thẻ thanh toán</div>
                        <hr class="divider" />

                        <MudRadioGroup @bind-Value="paymentMethod" ReadOnly="true">
                            @foreach (var method in paymentMethods)
                            {
                                <MudRadio Value="@method.Title" Style="width:25%" Class="m-0">
                                    <div class="mb-4">
                                        <MudImage Src="@($"/assets/images/payment-method/{method.IconPath}")"
                                                  Width="45" Class="rounded-lg" />
                                        <p class="method-title">@method.Title</p>
                                    </div>
                                </MudRadio>
                            }
                        </MudRadioGroup>
                    </div>
                </MudPaper>

                <MudPaper Elevation="0" Class="d-flex justify-content-between px-3 py-4 rounded-0">
                    <div class="">
                        <div class="note-before-next">
                            Vui lòng kiểm tra thông tin đầy đủ trước khi qua bước tiếp theo.
                        </div>
                        <div class="note-refund">
                            <span style="color: red;">* </span>
                            Vé mua rồi không hoàn trả lại dưới mọi hình thức.
                        </div>
                    </div>
                </MudPaper>

            </MudCardContent>
        </MudCard>

        <MudCard Elevation="0" Class="d-flex flex-column mt-6" Style="width:32%;height:fit-content">
            <MudCardContent Class="p-0 d-flex">
                <MudImage Src="@($"/assets/images/posters/{ReservationState.Value.Showtime.Movie.Poster}")"
                Fluid="true" Class="px-3 ml-n3" Style="width:50%" />
                <p class="movie-title px-3 py-5" style="color:#03599d">
                    @ReservationState.Value.Showtime.Movie.MovieName
                </p>
            </MudCardContent>

            <MudCardContent Class="px-8 py-3 d-flex flex-column gap-4">
                <div class="detail-infos">
                    @foreach (var info in movieInfos)
                    {
                        <div class="info-wrapper">
                            <div class="info-title">
                                <i class="@info.IconClass" style="font-size:14px"></i>
                                @($"{info.Title}:")
                            </div>
                            <span class="info-content">@info.Content</span>
                        </div>
                    }
                </div>
            </MudCardContent>

            <hr class="info-divider">

            <MudCardContent Class="px-8 py-3 d-flex flex-column gap-4">
                <div class="detail-infos">
                    @foreach (var info in showtimeInfos)
                    {
                        <div class="info-wrapper">
                            <div class="info-title">
                                <i class="@info.IconClass" style="font-size:14px"></i>
                                @($"{info.Title}")
                            </div>
                            <span class="info-content">@info.Content</span>
                        </div>
                    }

                    <div class="info-wrapper">
                        <div class="info-title">
                            <i class="fas fa-cubes" style="font-size:14px"></i>
                            Ghế ngồi
                        </div>
                        <span class="info-content">
                            @(string.Join(", ", ReservationState.Value.SelectedSeat.Select(s => $"{s.RowNum}{s.SeatNum}")))
                        </span>
                    </div>
                </div>
            </MudCardContent>

            <MudCardActions Class="pb-8 d-flex justify-content-center gap-3">
                <MudButton Size="Size.Large" Variant="Variant.Filled" Color="Color.Primary" OnClick="NavigateToReservation">
                    <p class="submit-button">@SharedResources.GoBack</p>
                </MudButton>
                <MudButton Size="Size.Large" Variant="Variant.Filled" Color="Color.Primary" OnClick="NavigateToExternalPayment">
                    <p class="submit-button">@SharedResources.Continue</p>
                </MudButton>
            </MudCardActions>
        </MudCard>
    </div>
</div>